<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResizedImage - Resize Images Effortlessly</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    animation: {
                        'bg-shift': 'bgShift 28s linear infinite',
                    },
                    keyframes: {
                        bgShift: {
                            '0%': { transform: 'translate3d(0,0,0)' },
                            '50%': { transform: 'translate3d(-2%,1%,0)' },
                            '100%': { transform: 'translate3d(0,0,0)' },
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="new-design.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4695148041573402"
       crossorigin="anonymous"></script>
    <style type="text/css">
        

        /* New styles from provided HTML */
        .grain-overlay {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200"><filter id="n"><feTurbulence baseFrequency="0.75" numOctaves="2"/></filter><rect width="200" height="200" filter="url(%23n)"/></svg>');
        }
        
        @media (max-width: 768px) {
            .mobile-nav-menu {
                display: none;
            }
            
            .mobile-nav-menu.active {
                display: flex;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(255, 255, 255, 0.1);
                backdrop-filter: blur(12px);
                border-top: 1px solid rgba(255, 255, 255, 0.15);
                flex-direction: column;
                padding: 1rem;
                z-index: 10;
            }
        }
        
        .file-input-hidden {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .toast-transition {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
    </style>
</head>
<body class="min-h-screen text-slate-50 relative overflow-x-hidden">
    <!-- Background: big soft radial glows + subtle grain -->
    <div class="pointer-events-none absolute inset-0 -z-10">
        <div class="absolute inset-0 opacity-90" 
             style="background: radial-gradient(1200px 800px at 20% 15%, rgba(118,142,255,0.22) 0%, transparent 60%), radial-gradient(900px 700px at 80% 85%, rgba(255,179,120,0.22) 0%, transparent 55%); background-size: 120% 120%;"
             class="animate-bg-shift">
        </div>
        <div class="absolute inset-0 mix-blend-soft-light opacity-[0.08] grain-overlay"></div>
    </div>

    <!-- Mobile menu button (hidden on desktop) -->
    <div class="md:hidden fixed top-4 right-4 z-30">
        <button id="mobile-menu-btn" class="p-2 rounded-lg bg-white/10 backdrop-blur-md border border-white/15">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
        </button>
    </div>

    <!-- Top Nav -->
    <nav class="sticky top-0 z-20">
        <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-3">
            <div class="flex items-center justify-between rounded-full bg-white/10 backdrop-blur-md border border-white/15 px-4 py-2">
                <div class="flex items-center gap-3">
                    <div class="size-8 rounded-lg bg-white/15 grid place-items-center">📷</div>
                    <a href="/" class="font-semibold tracking-tight">ResizedImage.com</a>
                </div>
                <div class="hidden md:flex items-center gap-6 text-sm text-slate-200">
                    <a href="/resizer" class="hover:text-white" aria-label="Image Resizer">Image Resizer</a>
                    <a href="/pdf" class="hover:text-white" aria-label="PDF Tools">PDF Tools</a>
                    <a href="/bg-remover" class="hover:text-white" aria-label="Background Remover">BG Remover</a>
                </div>
                <div class="hidden md:flex items-center gap-2">
                    <a href="/login" class="px-3 py-1.5 rounded-full text-sm bg-white/10 hover:bg-white/15 border border-white/15" aria-label="Login">
                        Login
                    </a>
                    <a href="/signup" class="px-3 py-1.5 rounded-full text-sm bg-white/10 hover:bg-white/15 border border-white/15" aria-label="Sign Up">
                        Sign Up
                    </a>
                    <a id="go-pro-btn" href="https://buy.stripe.com/test_cNiaEP5dQeOB5e5a255os02" class="ml-1 px-3 py-1.5 rounded-full text-sm font-semibold bg-indigo-400/90 hover:bg-indigo-400 text-slate-900" aria-label="Go Pro">
                        Go Pro
                    </a>
                </div>
                
                <!-- Mobile menu (hidden on desktop) -->
                <div class="md:hidden mobile-nav-menu" id="mobile-nav">
                    <div class="flex flex-col space-y-4 py-4">
                        <a href="/resizer" class="hover:text-white" aria-label="Image Resizer">Image Resizer</a>
                        <a href="/pdf" class="hover:text-white" aria-label="PDF Tools">PDF Tools</a>
                        <a href="/bg-remover" class="hover:text-white" aria-label="Background Remover">BG Remover</a>
                        <div class="flex flex-col space-y-2 pt-4 border-t border-white/15">
                            <a href="/login" class="px-3 py-1.5 rounded-full text-sm bg-white/10 hover:bg-white/15 border border-white/15 text-center">
                                Login
                            </a>
                            <a href="/signup" class="px-3 py-1.5 rounded-full text-sm bg-white/10 hover:bg-white/15 border border-white/15 text-center">
                                Sign Up
                            </a>
                            <a href="https://buy.stripe.com/test_cNiaEP5dQeOB5e5a255os02" class="px-3 py-1.5 rounded-full text-sm font-semibold bg-indigo-400/90 hover:bg-indigo-400 text-slate-900 text-center">
                                Go Pro
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero -->
    <header class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8 text-center pt-16 md:pt-24">
        <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight">
            ResizedImage
        </h1>
        <p class="mt-3 text-slate-200/90 text-lg">
            Resize images effortlessly for free
        </p>
    </header>

    <!-- Upload Cards -->
    <main class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 mt-10">
        <div class="grid md:grid-cols-2 gap-6">
            <!-- Main Upload Card -->
            <div class="glass-card rounded-2xl border border-white/15 bg-white/8 backdrop-blur-xl shadow-[0_10px_40px_rgba(0,0,0,0.25)] p-8">
                <div class="flex flex-col items-center text-center gap-4">
                    <h2 class="text-2xl font-bold tracking-tight">
                        Upload an Image to Get Started
                    </h2>
                    <p class="text-slate-200/90 max-w-md">
                        Drag and drop a file or click the button below to select an image from your device.
                    </p>
                    
                    <button id="single-upload-btn"
                        class="mt-2 inline-flex items-center gap-3 rounded-xl bg-blue-500 hover:bg-blue-400 text-slate-900 font-semibold px-6 py-3 text-lg transition-colors shadow-lg shadow-blue-500/20">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                        </svg>
                        Select Image
                    </button>

                    <input id="single-file-input"
                        type="file"
                        accept=".jpg,.jpeg,.png,.webp"
                        class="file-input-hidden"
                    />

                    <p class="mt-2 text-xs text-slate-300">
                        Supports: JPG, PNG, WEBP (Max 10MB)
                    </p>
                </div>
            </div>

            <!-- PRO Batch Upload -->
            <div class="glass-card rounded-2xl border border-white/15 bg-white/8 backdrop-blur-xl shadow-[0_10px_40px_rgba(0,0,0,0.25)] p-8">
                <div class="flex flex-col items-center text-center gap-3">
                    <div class="flex items-center gap-2">
                        <h2 class="text-xl font-semibold">Batch Upload</h2>
                        <span class="text-[10px] font-bold bg-yellow-300 text-slate-900 px-2 py-0.5 rounded-full">PRO</span>
                    </div>
                    <p class="text-slate-200/90 text-sm max-w-md">
                        Process multiple images at once. Lifetime access for a small one-time payment.
                    </p>
                    
                    <button id="batch-upload-btn"
                        class="mt-2 inline-flex items-center gap-2 rounded-lg bg-purple-500 hover:bg-purple-400 text-slate-900 font-medium px-4 py-2 transition-colors shadow-lg shadow-purple-500/20">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M13 7H7v6h6V7z" />
                            <path fill-rule="evenodd" d="M2 5a2 2 0 012-2h12a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V5zm3 1a1 1 0 00-1 1v6a1 1 0 001 1h10a1 1 0 001-1V7a1 1 0 00-1-1H5z" clip-rule="evenodd" />
                        </svg>
                        Select Multiple Images
                    </button>

                    <input id="batch-file-input"
                        type="file"
                        multiple
                        accept=".jpg,.jpeg,.png,.webp"
                        class="file-input-hidden"
                    />
                </div>
            </div>
        </div>

        <!-- Error toast (initially hidden) -->
        <div id="error-toast" class="mt-4 rounded-lg bg-red-500/15 border border-red-500/30 text-red-200 px-4 py-2 toast-transition hidden opacity-0 transform -translate-y-2">
            <span id="error-message"></span>
        </div>

        <!-- Why Use Row -->
        <section class="mt-12">
            <h3 class="text-center text-3xl font-bold">Why Use ResizedImage.com?</h3>
            <div class="mt-8 grid md:grid-cols-3 gap-6">
                <div class="feature-card rounded-2xl border border-white/10 bg-white/5 p-6 text-center">
                    <div class="text-3xl mb-2">⚡</div>
                    <div class="font-semibold text-lg">Lightning Fast</div>
                    <p class="mt-2 text-slate-200/90">Resize images in seconds without compromising quality using our optimized algorithms.</p>
                </div>
                <div class="feature-card rounded-2xl border border-white/10 bg-white/5 p-6 text-center">
                    <div class="text-3xl mb-2">🔒</div>
                    <div class="font-semibold text-lg">Secure & Private</div>
                    <p class="mt-2 text-slate-200/90">Your images are processed in your browser and never uploaded to our servers.</p>
                </div>
                <div class="feature-card rounded-2xl border border-white/10 bg-white/5 p-6 text-center">
                    <div class="text-3xl mb-2">🎚️</div>
                    <div class="font-semibold text-lg">Advanced Controls</div>
                    <p class="mt-2 text-slate-200/90">Precise dimension control, quality adjustment, and multiple format options.</p>
                </div>
            </div>
        </section>
        
        <!-- Upload Stats Section -->
        <section class="mt-16 text-center">
            <h3 class="text-2xl font-bold mb-6">Trusted by Thousands</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                <div class="p-4">
                    <div class="text-3xl font-bold text-blue-400">500K+</div>
                    <div class="text-slate-300">Images Resized</div>
                </div>
                <div class="p-4">
                    <div class="text-3xl font-bold text-green-400">99%</div>
                    <div class="text-slate-300">Satisfaction Rate</div>
                </div>
                <div class="p-4">
                    <div class="text-3xl font-bold text-purple-400">2s</div>
                    <div class="text-slate-300">Avg. Processing Time</div>
                </div>
                <div class="p-4">
                    <div class="text-3xl font-bold text-yellow-400">100%</div>
                    <div class="text-slate-300">Browser Processing</div>
                </div>
            </div>
        </section>
    </main>

    <!-- Testimonials -->
    <section class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 mt-16">
        <h3 class="text-center text-2xl font-bold mb-8">What Our Users Say</h3>
        <div class="grid md:grid-cols-3 gap-6">
            <div class="bg-white/5 p-6 rounded-2xl border border-white/10">
                <div class="flex items-center mb-4">
                    <div class="text-yellow-400 text-xl">★★★★★</div>
                </div>
                <p class="text-slate-200/90">"The fastest image resizer I've ever used. Perfect for my social media content!"</p>
                <div class="mt-4 text-sm text-slate-400">- Sarah, Photographer</div>
            </div>
            <div class="bg-white/5 p-6 rounded-2xl border border-white/10">
                <div class="flex items-center mb-4">
                    <div class="text-yellow-400 text-xl">★★★★★</div>
                </div>
                <p class="text-slate-200/90">"Love that my images never leave my browser. Privacy matters!"</p>
                <div class="mt-4 text-sm text-slate-400">- Michael, Designer</div>
            </div>
            <div class="bg-white/5 p-6 rounded-2xl border border-white/10">
                <div class="flex items-center mb-4">
                    <div class="text-yellow-400 text-xl">★★★★★</div>
                </div>
                <p class="text-slate-200/90">"Batch processing saved me hours of work. Well worth the $2!"</p>
                <div class="mt-4 text-sm text-slate-400">- Jessica, Blogger</div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 py-10 text-sm text-slate-300/90 mt-16">
        <div class="flex flex-wrap items-center justify-center gap-4">
            <a href="/terms" class="hover:text-white">Terms</a>
            <a href="/privacy" class="hover:text-white">Privacy</a>
            <a href="/contact" class="hover:text-white">Contact</a>
            <a href="/api" class="hover:text-white">API</a>
            <a href="/blog" class="hover:text-white">Blog</a>
        </div>
        <p class="text-center mt-4 opacity-80">© 2023 ResizedImage.com — All rights reserved</p>
    </footer>

    <!-- Modals from original index.html -->
    <div id="editor-modal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center hidden">
      <div class="glass-card rounded-2xl border border-white/15 bg-white/5 backdrop-blur-xl w-11/12 max-w-6xl h-[80vh] flex flex-col">
        <!-- Modal Header -->
        <div class="flex items-center justify-between p-4 border-b border-white/15">
        <h2 class="text-xl font-semibold">Image Editor</h2>
        <div class="flex items-center gap-2">
            <button id="rotate-left-btn" class="p-2 rounded-lg hover:bg-white/10 transition-colors" title="Rotate Left" aria-label="Rotate Left">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm.707-10.293a1 1 0 00-1.414-1.414l-3 3a1 1 0 000 1.414l3 3a1 1 0 001.414-1.414L9.414 11H13a1 1 0 100-2H9.414l1.293-1.293z" clip-rule="evenodd" />
                </svg>
            </button>
            <button id="rotate-right-btn" class="p-2 rounded-lg hover:bg-white/10 transition-colors" title="Rotate Right" aria-label="Rotate Right">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm-1.707-7.293a1 1 0 00-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 10.586V7a1 1 0 10-2 0v3.586l-1.293-1.293z" clip-rule="evenodd" />
                </svg>
            </button>
            <button id="crop-btn" class="p-2 rounded-lg hover:bg-white/10 transition-colors" title="Crop Image" aria-label="Crop Image">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M15 2a1 1 0 011 1v2a1 1 0 11-2 0V3H6v10h2a1 1 0 110 2H6a1 1 0 01-1-1V3a1 1 0 011-1h9zM3 6a1 1 0 011-1h2a1 1 0 110 2H4v10h10v-2a1 1 0 112 0v2a1 1 0 01-1 1H4a1 1 0 01-1-1V6z" />
                </svg>
            </button>
            <button id="close-editor-btn" class="p-2 rounded-lg hover:bg-white/10 transition-colors" title="Close" aria-label="Close Editor">
                 <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd" />
                </svg>
            </button>
            </div>
        </div>
        
        <!-- Modal Body -->
        <div class="flex-1 flex overflow-hidden">
            <!-- Main Content -->
            <div class="flex-1 flex items-center justify-center p-4 bg-black/20">
                <div id="preview-panel" class="w-full h-full flex items-center justify-center relative">
                    <p class="text-slate-400">Image Preview</p>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="w-80 bg-white/5 border-l border-white/15 overflow-y-auto">
                <div class="p-4">
                    <div class="space-y-2">
                        <button class="tab-btn active-tab" data-tab="by-size">By Size</button>
                        <button class="tab-btn" data-tab="as-percentage">As Percentage</button>
                        <button class="tab-btn" data-tab="social-media">Social Media</button>
                    </div>
     <div id="by-size" class="tab-content">
     <div class="flex items-center mb-4">
     <label for="width" class="w-16">Width:</label>
     <input type="number" id="width" class="form-input w-24">
     </div>
     <div class="flex items-center mb-4">
     <label for="height" class="w-16">Height:</label>
     <input type="number" id="height" class="form-input w-24">
     </div>
     <div class="flex items-center">
     <input type="checkbox" id="lock-aspect" class="mr-2" checked>
     <label for="lock-aspect">Lock aspect ratio</label>
     </div>
     <div class="flex items-center mt-4">
     <input type="checkbox" id="background-fill" class="mr-2">
     <label for="background-fill">Background Fill</label>
     <input type="color" id="background-color" class="ml-2" value="#ffffff">
     </div>
     </div>
     <div class="flex items-center mt-4">
     <label for="as-percentage-units" class="mr-2">Units:</label>
     <select id="as-percentage-units" class="form-select">
     <option value="px">Pixels</option>
     <option value="in">Inches</option>
     <option value="cm">Centimeters</option>
     <option value="mm">Millimeters</option>
     </select>
     </div>
     <div id="as-percentage" class="tab-content hidden">
     <div class="flex items-center mb-4">
     <input type="range" id="percentage-slider" min="1" max="200" value="100" class="w-full mr-4">
     <span id="percentage-value">100%</span>
     </div>
     </div>
     <div id="social-media" class="tab-content hidden">
     <div class="flex items-center mb-4">
     <label for="social-platform" class="mr-2">Platform:</label>
     <select id="social-platform" class="form-select w-full">
     <option value="">Select Platform</option>
     </select>
     </div>
     <div class="flex items-center mb-4">
     <label for="social-preset" class="mr-2">Preset:</label>
     <select id="social-preset" class="form-select w-full" disabled>
     <option value="">Select Preset</option>
     </select>
     </div>
     </div>
     <div class="mt-8">
     <h3 class="text-lg font-semibold mb-4">Export Settings</h3>
     <div class="flex items-center mb-4">
     <label for="target-size" class="mr-2">Target File Size (optional):</label>
     <input type="number" id="target-size" class="form-input w-24">
     <select id="target-size-unit" class="form-select ml-2">
     <option value="KB">KB</option>
     <option value="MB">MB</option>
     </select>
     </div>
     <div class="flex items-center mb-4">
     <label for="format" class="mr-2">Save Image As:</label>
     <select id="format" class="form-select">
     <option value="original">Original</option>
     <option value="jpeg">JPEG</option>
     <option value="png">PNG</option>
     <option value="webp">WebP</option>
     </select>
     </div>
                    <button id="export-btn" class="mt-4 w-full inline-flex items-center justify-center gap-2 rounded-lg bg-blue-500 hover:bg-blue-400 text-slate-900 font-semibold px-4 py-2 transition-colors shadow-lg shadow-blue-500/20">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                        </svg>
                        Export Image
                    </button>
                    <button id="export-btn" class="mt-4 w-full inline-flex items-center justify-center gap-2 rounded-lg bg-blue-500 hover:bg-blue-400 text-slate-900 font-semibold px-4 py-2 transition-colors shadow-lg shadow-blue-500/20">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM6.293 6.707a1 1 0 010-1.414l3-3a1 1 0 011.414 0l3 3a1 1 0 01-1.414 1.414L11 5.414V13a1 1 0 11-2 0V5.414L7.707 6.707a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                        </svg>
                        Export Image
                    </button>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div id="crop-modal" class="fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center hidden">
     <div class="bg-gray-800 rounded-lg shadow-xl w-11/12 max-w-4xl">
     <div class="p-8">
     <h2 class="text-2xl font-bold">Crop Image</h2>
     <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
     <div class="md:col-span-2">
     <div id="crop-preview-panel" class="bg-gray-700 h-96 relative overflow-hidden">
     </div>
     </div>
     <div>
     <h3 class="text-lg font-semibold mb-4">Crop Rectangle</h3>
     <div class="flex items-center mb-4">
     <label for="crop-width" class="w-16">Width:</label>
     <input type="number" id="crop-width" class="w-24 border border-gray-600 rounded px-2 py-1 bg-gray-800 text-white">
     </div>
     <div class="flex items-center mb-4">
     <label for="crop-height" class="w-16">Height:</label>
     <input type="number" id="crop-height" class="w-24 border border-gray-600 rounded px-2 py-1 bg-gray-800 text-white">
     </div>
     <div class="flex items-center mb-4">
     <label for="aspect-ratio" class="mr-2">Aspect Ratio:</label>
     <select id="aspect-ratio" class="border border-gray-600 rounded px-2 py-1 bg-gray-800 text-white">
     <option value="free">Freeform</option>
     <option value="original">Original</option>
     <option value="custom">Custom</option>
     <option value="1:1">1:1 (Square)</option>
     <option value="4:3">4:3 (Monitor)</option>
     <option value="16:9">16:9 (Widescreen)</option>
     <option value="16:10">16:10</option>
     <option value="3:2">3:2</option>
     <option value="5:4">5:4</option>
     <option value="2:1">2:1</option>
     <option value="3:1">3:1</option>
     <option value="4:1">4:1</option>
     <option value="14:9">14:9</option>
     <option value="19:10">19:10</option>
     <option value="21:9">21:9 (Cinemascope)</option>
     <option value="32:9">32:9 (Super Ultra Wide)</option>
     </select>
     </div>
     <button id="apply-crop-btn" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded w-full mb-2">
     Crop
     </button>
     <button id="reset-crop-btn" class="bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded w-full">
     Reset
     </button>
     </div>
     </div>
     </div>
     </div>
    </div>

    <script src="https://unpkg.com/cropperjs@1.5.13/dist/cropper.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const MAX_MB = 10;
            // Renamed from uploadSingleBtn to singleUploadBtn
            const singleUploadBtn = document.getElementById('single-upload-btn');
            // Renamed from uploadBatchBtn to batchUploadBtn
            const batchUploadBtn = document.getElementById('batch-upload-btn');
            const singleFileInput = document.getElementById('single-file-input');
            const batchFileInput = document.getElementById('batch-file-input');
            // Renamed from errorDisplay to errorToast and errorMessage
            const errorToast = document.getElementById('error-toast');
            const errorMessage = document.getElementById('error-message');
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const mobileNav = document.getElementById('mobile-nav');

            // Modals and editor elements (from original JS)
            const editorModal = document.getElementById('editor-modal');
            const closeEditorBtn = document.getElementById('close-editor-btn');
            const widthInput = document.getElementById('width');
            const heightInput = document.getElementById('height');
            const lockAspectCheckbox = document.getElementById('lock-aspect');
            let originalWidth, originalHeight;
            const percentageSlider = document.getElementById('percentage-slider');
            const percentageValueSpan = document.getElementById('percentage-value');
            const unitsSelect = document.getElementById('as-percentage-units');
            const socialPlatformSelect = document.getElementById('social-platform');
            const socialPresetSelect = document.getElementById('social-preset');
            let socialPresets = {};
            const exportBtn = document.getElementById('export-btn');
            const cropBtn = document.getElementById('crop-btn');
            const cropModal = document.getElementById('crop-modal');
            const cropPreviewPanel = document.getElementById('crop-preview-panel');
            const applyCropBtn = document.getElementById('apply-crop-btn');
            const resetCropBtn = document.getElementById('reset-crop-btn');
            const aspectRatioSelect = document.getElementById('aspect-ratio');
            const cropWidthInput = document.getElementById('crop-width');
            const cropHeightInput = document.getElementById('crop-height');
            let cropper;
            let currentImageSrc = '';
            const rotateLeftBtn = document.getElementById('rotate-left-btn');
            const rotateRightBtn = document.getElementById('rotate-right-btn');
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            // Mobile menu toggle
            mobileMenuBtn.addEventListener('click', function() {
                mobileNav.classList.toggle('active');
            });
            
            // Close mobile menu when clicking outside
            document.addEventListener('click', function(event) {
                if (!mobileMenuBtn.contains(event.target) && !mobileNav.contains(event.target)) {
                    mobileNav.classList.remove('active');
                }
            });
            
            // Button triggers file input
            singleUploadBtn.addEventListener('click', function() {
                singleFileInput.click();
            });
            
            batchUploadBtn.addEventListener('click', async function() {
                if (await isPro()) {
                    batchFileInput.click();
                } else {
                    location.href = 'https://buy.stripe.com/test_cNiaEP5dQeOB5e5a255os02';
                }
            });
            
            // File validation function
            function validateFiles(files) {
                const tooBig = Array.from(files).find(f => f.size > MAX_MB * 1024 * 1024);
                if (tooBig) {
                    return `"${tooBig.name}" is over ${MAX_MB}MB. Please pick smaller files.`;
                }
                return null;
            }
            
            // Show error toast
            function showError(message) {
                errorMessage.textContent = message;
                errorToast.classList.remove('hidden');
                setTimeout(() => {
                    errorToast.classList.remove('opacity-0');
                    errorToast.classList.remove('-translate-y-2');
                }, 10);
                
                // Auto hide after 5 seconds
                setTimeout(() => {
                    hideError();
                }, 5000);
            }
            
            // Hide error toast
            function hideError() {
                errorToast.classList.add('opacity-0');
                errorToast.classList.add('-translate-y-2');
                setTimeout(() => {
                    errorToast.classList.add('hidden');
                }, 300); // Match transition duration
            }

            // isPro and redeem functions (from original JS)
            async function isPro() {
                try {
                    const r = await fetch('/me', { credentials: 'include' });
                    return (await r.json()).pro;
                } catch {
                    return false;
                }
            }
           
            async function redeem() {
                const t = new URLSearchParams(location.search).get('token');
                if (!t) return;
                const r = await fetch('/unlock?token=' + encodeURIComponent(t), { credentials: 'include' });
                const j = await r.json();
                if (j.ok) {
                    const u = new URL(location.href);
                    u.searchParams.delete('token');
                    history.replaceState({}, '', u);
                }
            }
           
            (async () => {
                await redeem();
                if (await isPro()) {
                    const unlockProBtn = document.getElementById('unlock-pro-btn');
                    if (unlockProBtn) {
                        unlockProBtn.textContent = 'PRO User';
                        unlockProBtn.removeAttribute('href'); // Remove the link
                        unlockProBtn.style.cursor = 'default'; // Change cursor to indicate it's not clickable
                        unlockProBtn.classList.remove('bg-indigo-400/90', 'hover:bg-indigo-400', 'text-slate-900');
                        unlockProBtn.classList.add('bg-gray-600', 'text-white', 'cursor-not-allowed'); // New styling for PRO User
                    }
                    // Also update the mobile menu pro button
                    const mobileProBtn = document.querySelector('#mobile-nav a[href="https://buy.stripe.com/test_cNiaEP5dQeOB5e5a255os02"]');
                    if (mobileProBtn) {
                        mobileProBtn.textContent = 'PRO User';
                        mobileProBtn.removeAttribute('href');
                        mobileProBtn.style.cursor = 'default';
                        mobileProBtn.classList.remove('bg-indigo-400/90', 'hover:bg-indigo-400', 'text-slate-900'); // Remove old styling
                        mobileProBtn.classList.add('bg-gray-600', 'text-white', 'cursor-not-allowed'); // New styling for PRO User
                    }
                }
            })();

            // Event listener for single file input change (from original JS)
            singleFileInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file) {
                    const validationError = validateFiles([file]);
                    if (validationError) {
                        showError(validationError);
                        return;
                    }
                    
                    const reader = new FileReader();
                    reader.onload = (event) => {
                        const img = new Image();
                        img.onload = () => {
                            originalWidth = img.naturalWidth;
                            originalHeight = img.naturalHeight;
                            widthInput.value = originalWidth;
                            heightInput.value = originalHeight;
                            percentageSlider.value = 100;
                            percentageValueSpan.textContent = '100%';
                            
                            const previewPanel = document.getElementById('preview-panel');
                            previewPanel.innerHTML = '';
                            previewPanel.appendChild(img);
                            editorModal.classList.remove('hidden');
                        };
                        img.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });
           
            // Event listener for batch file input change (from original JS)
            batchFileInput.addEventListener('change', (e) => {
                const files = e.target.files;
                if (files.length > 0) {
                    const validationError = validateFiles(files);
                    if (validationError) {
                        showError(validationError);
                        return;
                    }
                    // For batch, we might want to show a different modal or process differently
                    // For now, just open the editor modal as a placeholder
                    editorModal.classList.remove('hidden');
                }
            });

            function updatePreview() {
                const previewPanel = document.getElementById('preview-panel');
                const currentImage = previewPanel.querySelector('img');
                if (!currentImage) return;

                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');

                const targetWidth = parseInt(widthInput.value);
                const targetHeight = parseInt(heightInput.value);

                canvas.width = targetWidth;
                canvas.height = targetHeight;

                ctx.drawImage(currentImage, 0, 0, targetWidth, targetHeight);
                currentImage.src = canvas.toDataURL();
            }
            // Resize functionality (from original JS)
            function handleResize() {
                if (!originalWidth || !originalHeight) return;

                const aspectRatio = originalWidth / originalHeight;
                let width = parseInt(widthInput.value);
            
                let height = parseInt(heightInput.value);

                if (isNaN(width) && isNaN(height)) return;

                if (lockAspectCheckbox.checked) {
                    if (document.activeElement === widthInput && !isNaN(width)) {
                        heightInput.value = Math.round(width / aspectRatio);
                    } else if (!isNaN(height)) {
                        widthInput.value = Math.round(height * aspectRatio);
                    }
                }
                
                // Update percentage slider
                if (!isNaN(width)) {
                    const percentage = Math.round((width / originalWidth) * 100);
                    percentageSlider.value = percentage;
                    percentageValueSpan.textContent = `${percentage}%`;
                }
            }

            widthInput.addEventListener('input', handleResize);
            heightInput.addEventListener('input', handleResize);
            lockAspectCheckbox.addEventListener('change', handleResize);

            function updatePercentageResize() {
                if (!originalWidth || !originalHeight) return;

                const percentage = parseInt(percentageSlider.value);
                percentageValueSpan.textContent = `${percentage}%`;

                const newWidth = Math.round(originalWidth * (percentage / 100));
                const newHeight = Math.round(originalHeight * (percentage / 100));

                widthInput.value = newWidth;
                heightInput.value = newHeight;
            }

            percentageSlider.addEventListener('input', updatePercentageResize);
            unitsSelect.addEventListener('change', () => {
                console.log(`Selected unit: ${unitsSelect.value}`);
            });
           
            // Social presets (from original JS)
            async function loadSocialPresets() {
                const res = await fetch('/socialPresets.json');
                socialPresets = await res.json();
                for (const platform in socialPresets) {
                    const option = document.createElement('option');
                    option.value = platform;
                    option.textContent = platform;
                    socialPlatformSelect.appendChild(option);
                }
            }
           
            socialPlatformSelect.addEventListener('change', () => {
                const platform = socialPlatformSelect.value;
                socialPresetSelect.innerHTML = '<option value="">Select Preset</option>';
                if (platform) {
                    socialPresetSelect.disabled = false;
                    for (const preset in socialPresets[platform]) {
                        const option = document.createElement('option');
                        option.value = preset;
                        option.textContent = preset;
                        socialPresetSelect.appendChild(option);
                    }
                } else {
                    socialPresetSelect.disabled = true;
                }
            });
           
            socialPresetSelect.addEventListener('change', () => {
                const platform = socialPlatformSelect.value;
                const preset = socialPresetSelect.value;
                if (platform && preset) {
                    const { width, height } = socialPresets[platform][preset];
                    widthInput.value = width;
                    heightInput.value = height;
                }
            });
           
            loadSocialPresets();
           
            // Export functionality (from original JS)
            exportBtn.addEventListener('click', async () => {
                const image = document.getElementById('preview-panel').querySelector('img');
                if (!image || !image.src) {
                    showError('Please upload an image first.');
                    return;
                }

                const format = document.getElementById('format').value;
                const targetSize = document.getElementById('target-size').value;
                const targetSizeUnit = document.getElementById('target-size-unit').value;

                const formData = new FormData();
                const originalBlob = await (await fetch(image.src)).blob();
                formData.append('files', originalBlob, 'image' + (format ? `.${format}`: ''));

                formData.append('w', widthInput.value);
                formData.append('h', heightInput.value);
                formData.append('fmt', format);
                formData.append('q', 0.85); // Default quality
                formData.append('keepAspect', lockAspectCheckbox.checked ? '1' : '0');
                if (document.getElementById('background-fill').checked) {
                    formData.append('backgroundColor', document.getElementById('background-color').value);
                }
                if (targetSize) {
                    formData.append('targetSize', targetSize);
                    formData.append('targetSizeUnit', targetSizeUnit);
                }

                try {
                    const res = await fetch('/process', {
                        method: 'POST',
                        body: formData,
                    });

                    if (res.ok) {
                        const blob = await res.blob();
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement('a');
                        const extension = format === 'original' ? 'jpg' : format;
                        a.download = `resized.${extension}`;
                        a.href = url;
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    } else {
                        const errorText = await res.text();
                        showError(`Error: ${errorText}`);
                    }
                } catch (error) {
                    showError('An unexpected error occurred during export.');
                }
            });
           
            // Crop functionality
            cropBtn.addEventListener('click', () => {
                const image = document.getElementById('preview-panel').querySelector('img');
                if (!image) {
                    showError('Please upload an image first.');
                    return;
                }
                currentImageSrc = image.src;
                
                cropPreviewPanel.innerHTML = `<img src="${currentImageSrc}" style="display: block; max-width: 100%;">`;
                const cropImage = cropPreviewPanel.querySelector('img');
                
                cropModal.classList.remove('hidden');

                if (cropper) {
                    cropper.destroy();
                }

                cropper = new Cropper(cropImage, {
                    viewMode: 1,
                    autoCropArea: 1,
                    background: false,
                    responsive: true,
                    crop(event) {
                        cropWidthInput.value = Math.round(event.detail.width);
                        cropHeightInput.value = Math.round(event.detail.height);
                    },
                });
            });

            applyCropBtn.addEventListener('click', () => {
                if (cropper) {
                    const croppedCanvas = cropper.getCroppedCanvas({
                        imageSmoothingEnabled: true,
                        imageSmoothingQuality: 'high',
                    });
                    const image = document.getElementById('preview-panel').querySelector('img');
                    
                    // Update the main preview with the cropped image
                    image.src = croppedCanvas.toDataURL();
                    
                    // Update original dimensions to cropped dimensions
                    originalWidth = croppedCanvas.width;
                    originalHeight = croppedCanvas.height;
                    widthInput.value = originalWidth;
                    heightInput.value = originalHeight;
                    
                    cropper.destroy();
                    cropper = null;
                    cropModal.classList.add('hidden');
                }
            });
           
            resetCropBtn.addEventListener('click', () => {
                if (cropper) {
                    cropper.reset();
                }
            });
           
            aspectRatioSelect.addEventListener('change', () => {
                if (cropper) {
                    const aspectRatio = aspectRatioSelect.value;
                    if (aspectRatio === 'free') {
                        cropper.setAspectRatio(NaN);
                    } else if (aspectRatio === 'original') {
                        const cropImage = cropPreviewPanel.querySelector('img');
                        if (cropImage) {
                            cropper.setAspectRatio(cropImage.naturalWidth / cropImage.naturalHeight);
                        }
                    } else {
                        const [w, h] = aspectRatio.split(':');
                        cropper.setAspectRatio(w / h);
                    }
                }
            });
           
            // Rotate functionality (from original JS)
            rotateLeftBtn.addEventListener('click', () => {
                const image = document.getElementById('preview-panel').querySelector('img');
                if (image) {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = image.height;
                    canvas.height = image.width;
                    ctx.translate(canvas.width / 2, canvas.height / 2);
                    ctx.rotate(-Math.PI / 2);
                    ctx.drawImage(image, -image.width / 2, -image.height / 2);
                    image.src = canvas.toDataURL();
                }
            });
           
            rotateRightBtn.addEventListener('click', () => {
                const image = document.getElementById('preview-panel').querySelector('img');
                if (image) {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');
                    canvas.width = image.height;
                    canvas.height = image.width;
                    ctx.translate(canvas.width / 2, canvas.height / 2);
                    ctx.rotate(Math.PI / 2);
                    ctx.drawImage(image, -image.width / 2, -image.height / 2);
                    image.src = canvas.toDataURL();
                }
            });
           
            // Tab functionality for editor modal (from original JS)
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active-tab'));
                    tabContents.forEach(content => content.classList.add('hidden'));
           
                    button.classList.add('active-tab');
                    document.getElementById(button.dataset.tab).classList.remove('hidden');
                });
            });

            // Close editor modal
            closeEditorBtn.addEventListener('click', () => {
                editorModal.classList.add('hidden');
            });
        });
    </script>
</body>
</html>
